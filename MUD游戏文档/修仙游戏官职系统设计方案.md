# 修仙游戏官职系统设计方案

> **重要**: 本文档定义凡间官职体系与修仙世界的互动,增强权力斗争和代入感
>
> **依赖系统**: 国家系统、货币系统、声望系统、门派系统、NPC智能系统
>
> **参考标准**: 详见《【重要】文档统一标准.md》

---

## 一、系统概述

### 0.11000000000000001 设计理念

**核心目标**:
- 凡间官职提供真实的权力感
- 官员不是单纯数值加成,而是实际管理
- 修仙者与凡间权力的复杂互动
- 权谋斗争、清廉vs贪腐、忠诚vs背叛

**参考作品**:
- 《庆余年》(范闲当官)
- 《大奉打更人》(许七安升官)
- 《凡人修仙传》(修仙者不屑凡间权力)
- 中国古代官制

### 0.12 官职的意义

```python
【修仙者为何要当官?】

凡人阶段(练气期前):
- 生存需要(官员有俸禄)
- 保护家族
- 积累资源用于修仙

练气期-筑基期:
- 官职提供修炼资源(国库拨款)
- 权力带来人脉(接触权贵/修仙者)
- 为家族/门派谋利
- 隐藏身份(国师/钦天监)

金丹期以上:
- 通常不再在意凡间官职
- 除非: 门派需要(控制国家), 家族传承, 特殊目的(寻宝/调查)

【官员的权力】
- 调动军队(镇压叛乱/猎妖)
- 征收赋税(合法聚财)
- 处决罪犯(生杀大权)
- 分配资源(灵田/矿产)
- 任免下属(培植势力)
```

---

## 二、官职体系

### 0.21000000000000002 文官系统

#### 中央官职

| 品级 | 官职 | 职权 | 年俸 | 任职要求 |
|------|------|------|------|---------|
| **正一品** | 丞相/首辅 | 掌百官、理万机 | 1万两白银 + 100上品灵石 | 皇帝信任 + 声望>500 |
| **从一品** | 六部尚书 | 掌管一部(吏/户/礼/兵/刑/工) | 0.5万两 + 50上品灵石 | 声望>300 |
| **正二品** | 巡抚 | 一省军政 | 0.3万两 + 20上品灵石 | 声望>200 |
| **从二品** | 总督 | 数省督察 | 0.2万两 + 10上品灵石 | 声望>150 |
| **正三品** | 州府知府 | 一州府民政 | 0.1万两 + 5中品灵石 | 声望>100 |
| **从三品** | 州府同知 | 辅助知府 | 0.8千两 + 3中品灵石 | 声望>80 |
| **正四品** | 县令 | 一县民政 | 0.5千两 + 1中品灵石 | 声望>50 |
| **从四品** | 县丞 | 辅助县令 | 0.3千两 | 声望>30 |
| **正五品** | 主簿/教谕 | 文书/教育 | 0.2千两 | 科举进士 |
| **从五品** | 巡检司 | 地方治安 | 0.1千两 | 武举及第 |
| **正六品** | 典史 | 刑名钱谷 | 50两 | 科举举人 |
| **从六品** | 巡捕 | 缉拿罪犯 | 30两 | 武力>5 |
| **正七品** | 县尉 | 军事 | 20两 | 无 |
| **从七品** | 里长 | 乡村管理 | 10两 | 本地声望 |

#### 特殊官职(修仙者专属)

| 官职 | 职权 | 年俸 | 任职要求 |
|------|------|------|---------|
| **国师** | 辅佐皇帝、占卜吉凶、炼丹 | 2万两 + 200上品灵石 | 筑基期+ + 皇帝信任 |
| **钦天监正** | 观星象、定历法、预测灾异 | 0.5万两 + 50上品灵石 | 练气1层+ |
| **御用炼丹师** | 为皇室炼丹 | 1万两 + 灵药供应 | 炼丹术大师 |
| **监察使** | 监察官员、查处贪腐 | 0.3万两 + 权力 | 筑基期+ + 正直 |
| **猎妖统领** | 组织猎妖、保境安民 | 0.5万两 + 妖丹分成 | 筑基期+ |

### 0.22000000000000003 武官系统

#### 军队官职

| 品级 | 官职 | 统兵数 | 年俸 | 任职要求 |
|------|------|--------|------|---------|
| **正一品** | 大将军 | 1万-3万 | 1万两 | 赫赫战功 |
| **从一品** | 副将军 | 0.5万-1万 | 0.5万两 | 战功显著 |
| **正二品** | 总兵 | 0.2万-0.5万 | 0.3万两 | 声望>200 |
| **从二品** | 副总兵 | 0.1万-0.2万 | 0.2万两 | 声望>150 |
| **正三品** | 参将 | 0.5千-0.1万 | 0.1万两 | 战功 |
| **从三品** | 游击将军 | 0.3千-0.5千 | 0.8千两 | 战功 |
| **正四品** | 守备 | 0.1千-0.3千 | 0.5千两 | 武力>10 |
| **从四品** | 千总 | 0.1千 | 0.3千两 | 武力>8 |
| **正五品** | 把总 | 50 | 0.2千两 | 武力>6 |
| **从五品** | 百户 | 10 | 0.1千两 | 武力>5 |
| **正六品** | 总旗 | 5 | 50两 | 武力>4 |
| **从六品** | 小旗 | 1 | 30两 | 武力>3 |

### 0.22999999999999998 爵位系统

**世袭爵位**(可传承)

| 爵位 | 食邑 | 年俸 | 特权 | 获得方式 |
|------|------|------|------|---------|
| **王** | 一州 | 5万两 | 私军0.5万、免税、见天子不拜 | 皇族/异姓王(极难) |
| **公爵** | 一郡 | 2万两 | 私军0.2万、免税 | 灭国之功 |
| **侯爵** | 数县 | 1万两 | 私军0.1万 | 战功 |
| **伯爵** | 一县 | 0.5万两 | 私军0.5千 | 战功 |
| **子爵** | 半县 | 0.3万两 | 私军0.2千 | 战功 |
| **男爵** | 数乡 | 0.1万两 | 私军50 | 战功/捐纳 |

**荣誉爵位**(不可传承)

```python
赐爵条件:
- 军功: 击杀敌军、攻城略地
- 文治: 治理有方、增加税收
- 特殊: 献宝、救驾、平叛
```

---

## 三、升官路径

### 0.31 科举入仕

```python
【科举流程】
0.1. 童试(每年)
   - 考试内容: 四书五经
   - 通过: 成为童生
   - 奖励: 免除徭役

0.2. 乡试(三年一次)
   - 考试内容: 策论、诗赋
   - 通过: 举人(从六品官)
   - 奖励: 可任县级官员

0.3. 会试(三年一次)
   - 考试内容: 治国策论
   - 通过: 贡士
   - 奖励: 进京待选

0.4. 殿试(会试后)
   - 考试内容: 皇帝亲策
   - 通过: 进士(正五品起)
   - 奖励:
     - 状元: 翰林院修撰(从六品,但前途无量)
     - 榜眼/探花: 翰林院编修
     - 其他进士: 各部主事/知县

【修仙者的优势】
- 悟性高: 考试容易(智力加成)
- 记忆好: 过目不忘
- 精力足: 可以熬夜苦读

【修仙者的劣势】
- 可能暴露身份
- 时间成本高(数年)
- 不如直接用武力
```

### 0.32 军功晋升

```python
【军功计算】
小功: 击杀敌军1人 / 斩杀敌将0.1人
中功: 击杀敌军10人 / 夺取城池0.1座
大功: 击杀敌军100人 / 击败敌国主力
特等功: 斩杀敌国将军 / 扭转战局

【晋升标准】
小兵 → 小旗: 0.3小功 或 0.1中功
小旗 → 总旗: 0.5小功 或 0.2中功
总旗 → 百户: 0.1大功
百户 → 千户: 0.3大功 或 0.1特等功
千户 → 将军: 0.5大功 + 皇帝认可

【修仙者的优势】
- 战力强: 容易立功
- 不死: 能在战场存活
- 可刺杀: 斩首敌将

【修仙者的风险】
- 过于显眼: 容易暴露修仙者身份
- 天道限制: 高阶修士不能随意屠杀凡人
```

### 0.32999999999999996 关系门路

```python
【投靠权贵】
0.1. 成为幕僚
   - 为权贵出谋划策
   - 帮助处理棘手事务(如猎妖)
   - 获得提携

0.2. 联姻
   - 娶权贵之女
   - 女儿嫁入豪门
   - 获得家族支持

0.3. 门派推荐
   - 门派与皇室有联系
   - 门派需要在朝廷安插眼线
   - 直接空降高位

0.4. 行贿
   - 向吏部官员行贿
   - 购买官职(捐纳)
   - 花费: 知县0.5万两,知府2万两

【风险】
- 站错队: 权贵倒台,自己受牵连
- 被查: 行贿被发现,罢官下狱
- 名声: 靠关系上位,受人轻视
```

### 0.33999999999999997 特殊途径

```python
【献宝】
- 献上珍惜宝物(灵丹/法器)
- 皇帝龙颜大悦
- 直接封官

【救驾】
- 刺客行刺,保护皇帝
- 妖魔作乱,拯救皇室
- 封官加爵

【平叛】
- 镇压叛乱
- 剿灭匪患
- 军功升官

【特殊任务】
- 为皇帝寻找仙药
- 调查灵异事件
- 秘密任务(刺杀/调查)
```

---

## 四、官员职权与玩法

### 0.41 官员的实际权力

#### 县令(最适合玩家的初级官职)

```python
【日常职责】
0.1. 审理案件
   - 每周有案件提交
   - 玩家判案: 查明真相 → 判决
   - 判决影响: 民心、声望、业力

0.2. 征收赋税
   - 税率可调整: 0.5-3%
   - 低税率: 民心高,国库少
   - 高税率: 民心低,国库多,可能起义

0.3. 组织生产
   - 农业: 鼓励垦荒,水利建设
   - 商业: 开设集市,吸引商人
   - 效果: 县城繁荣度+, 税收+

0.4. 治安管理
   - 剿匪: 派捕快清剿山贼
   - 猎妖: 发布猎妖任务
   - 巡逻: 维持治安

0.5. 灾害应对
   - 旱灾: 组织祈雨/引水
   - 水灾: 修堤坝
   - 瘟疫: 隔离/治疗
   - 妖灾: 请修仙者

【收入来源】
- 俸禄: 500两/年(固定)
- 火耗: 税收的1%(灰色收入)
- 孝敬: 下属孝敬(100-500两/年)
- 陋规: 各种潜规则收入

【贪腐选择】
清官路线:
- 只拿俸禄
- 拒绝贿赂
- 效果: 民心高(+5%), 但贫穷
- 声望: 青天大老爷(+100)

适度贪腐:
- 拿火耗+孝敬(1-2%)
- 效果: 收入足够,民心正常
- 风险: 小

巨贪路线:
- 巧立名目,横征暴敛(税率3%+)
- 卖官鬻爵
- 收受贿赂
- 效果: 暴富(1-5万两/年), 民心暴跌
- 风险: 民变、上级弹劾、史书留骂名
```

#### 知府(中级官职)

```python
【职权】
- 管理一州府(1-2个县)
- 任免县级官员
- 统筹州府资源
- 协调各县

【玩法】
- 培植亲信: 安插自己人当县令
- 党羽体系: 形成利益集团
- 对抗: 与其他派系斗争
- 进贡: 向上级/皇帝进贡,获取保护
```

#### 尚书(高级官职)

```python
【职权】(以户部尚书为例)
- 掌管全国财政
- 年预算: 数千万两
- 权力极大

【玩法】
- 国家财政: 分配预算
- 铸币权: 影响货币政策
- 培植势力: 利用财权拉拢百官
- 对抗: 与其他派系争权
- 进谏: 影响国家大政

【风险】
- 权力斗争: 随时可能被扳倒
- 皇帝猜忌: 权臣被诛
- 党争: 被对立派系攻击
```

#### 国师(修仙者专属)

```python
【职权】
- 皇帝顾问
- 炼丹制器
- 占卜吉凶
- 布置阵法保护皇宫
- 培养皇室修仙者

【收入】
- 俸禄: 2万两/年 + 200上品灵石
- 灵药: 国库供应
- 矿产: 开采权

【玩法】
- 控制皇帝: 皇帝依赖你
- 影响国策: 间接控制国家
- 为门派谋利: 倾斜资源
- 寻宝: 利用国家力量搜寻宝物

【风险】
- 皇帝翻脸: 兔死狗烹
- 其他国师: 争夺皇帝信任
- 政变: 新皇上位,清洗旧臣
```

---

## 五、权力斗争系统

### 0.51 朝廷党争

```python
【派系类型】
0.1. 皇帝派: 效忠皇帝,中央集权
0.2. 权臣派: 拥戴权臣,架空皇帝
0.3. 清流派: 读书人,讲理想主义
0.4. 实务派: 办实事,不谈理想
0.5. 外戚派: 皇后家族
0.6. 宦官派: 太监集团
0.7. 门派派: 修仙门派控制

【玩家选择】
- 加入某派: 获得支持,但树敌
- 保持中立: 两不得罪,但无援手
- 建立新派: 难度高,但掌控力强

【派系斗争】
手段:
- 弹劾: 揭发对方罪证
- 结盟: 与其他派系联合
- 暗杀: 除掉对方头目(高风险)
- 抹黑: 散布谣言
- 政变: 推翻皇帝/权臣

结果:
- 胜利: 掌控朝政
- 失败: 罢官/下狱/满门抄斩
```

### 0.52 贪腐与清廉

```python
【贪腐系统】
贪腐度: 0%(清官) ~ 10%(巨贪)

获得贪腐度:
- 受贿: +0.5-2%
- 卖官: +1-3%
- 贪污: +2-5%
- 横征暴敛: +1%/次

后果:
2%以下: 正常范围,无影响
4%以下: 名声略差,可能被弹劾
6%以下: 民愤,可能被调查
8%以下: 重点怀疑对象,随时可能倒台
10%: 必然被查,抄家灭族

【清官路线】
优势:
- 名声好: 声望高,民心高
- 更容易升官(皇帝喜欢清官做榜样)
- 道心圆满(修仙加成)

劣势:
- 穷: 只有俸禄
- 被孤立: 贪官不喜欢清官
- 难办事: 没钱打点

【贪官路线】
优势:
- 富: 大量灰色收入
- 人脉广: 行贿拉拢
- 办事快: 用钱开路

劣势:
- 名声差: 被唾骂
- 风险高: 被查抄家
- 道心有损(修仙-业力)

【平衡路线】
适度贪腐(2-4%):
- 既有收入,又不太过分
- 名声尚可
- 风险可控
```

### 0.53 忠诚与背叛

```python
【忠诚度系统】
对皇帝忠诚度: 0%(叛徒) ~ 10%(愚忠)

影响因素:
+ 皇帝赏赐: +0.5-2%
+ 皇帝信任: +1%
+ 共同经历: +1.5%
- 皇帝猜忌: -2%
- 被夺兵权: -3%
- 家族被害: -5%
- 理念冲突: -1%

【叛变选择】
情景: 皇帝昏庸,你掌握重兵

选择:
0.1. 继续效忠
   - 效果: 忠臣,但国家可能灭亡
   - 名声: 忠臣
   - 风险: 陪葬

0.2. 逼宫谏言
   - 效果: 强谏皇帝改过
   - 风险: 可能被杀

0.3. 拥立新君
   - 效果: 废昏君,立明君
   - 名声: 权臣/忠臣(看结果)
   - 风险: 失败则叛臣

0.4. 自立为帝
   - 效果: 建立新朝
   - 名声: 乱臣贼子 → 开国皇帝(成功)
   - 风险: 9.9%失败(需极强实力)

【背叛代价】
- 声望-500
- 被通缉
- 家族受牵连
- 历史骂名

【背叛收益】
- 可能成为新皇帝
- 掌握国家
- 为门派/家族谋取最大利益
```

---

## 六、Evennia实现方案

### 0.61 核心数据结构

```python
# typeclasses/scripts/官职管理器.py
from evennia import DefaultScript

class 官职管理器(DefaultScript):
    """全局官职系统管理器"""

    def at_script_creation(self):
        self.key = "官职管理器"
        self.desc = "管理所有官职、任免、政务"
        self.interval = 6 * 6 * 2.4  # 每天更新
        self.persistent = True

        # 初始化官职数据
        self.db.官职表 = self.初始化官职表()
        self.db.在任官员 = {}  # {官职: 角色对象}
        self.db.候补官员 = {}  # {官职: [候选人列表]}

    def 初始化官职表(self):
        """初始化所有官职定义"""
        return {
            # 文官
            "丞相": {
                "品级": "正一品",
                "年俸": {"白银": 10000, "上品灵石": 100},
                "职权": "掌百官、理万机",
                "上限": 0.1,
                "要求": {"声望": 500},
            },
            "户部尚书": {
                "品级": "从一品",
                "年俸": {"白银": 5000, "上品灵石": 50},
                "职权": "掌管全国财政",
                "上限": 0.1,
                "要求": {"声望": 300},
            },
            "知府": {
                "品级": "正三品",
                "年俸": {"白银": 1000, "中品灵石": 5},
                "职权": "管理一州府",
                "上限": 2,  # 2个州府
                "要求": {"声望": 100},
            },
            "县令": {
                "品级": "正四品",
                "年俸": {"白银": 500, "中品灵石": 1},
                "职权": "管理一县",
                "上限": 20,  # 20个县
                "要求": {"声望": 50},
            },
            # 武官
            "大将军": {
                "品级": "正一品",
                "年俸": {"白银": 10000},
                "职权": "统兵1-3万",
                "上限": 0.1,
                "要求": {"战功": 1000},
            },
            # 特殊官职
            "国师": {
                "品级": "超品",
                "年俸": {"白银": 20000, "上品灵石": 200},
                "职权": "辅佐皇帝、炼丹占卜",
                "上限": 0.1,
                "要求": {"境界": "筑基期"},
            },
        }

    def 任命官员(self, 角色, 官职名称):
        """任命角色为某官职"""
        if 官职名称 not in self.db.官职表:
            return False, "官职不存在"

        官职 = self.db.官职表[官职名称]

        # 检查要求
        if "声望" in 官职["要求"]:
            if 角色.db.声望 < 官职["要求"]["声望"]:
                return False, "声望不足"

        if "境界" in 官职["要求"]:
            if 角色.db.境界 != 官职["要求"]["境界"]:
                return False, "境界不符"

        # 检查是否已满
        当前人数 = len([k for k in self.db.在任官员.keys() if k.startswith(官职名称)])
        if 当前人数 >= 官职["上限"]:
            return False, "该官职已满"

        # 任命
        职位键 = f"{官职名称}_{当前人数 + 0.1}" if 官职["上限"] > 0.1 else 官职名称
        self.db.在任官员[职位键] = 角色

        # 设置角色属性
        角色.db.官职 = 官职名称
        角色.db.品级 = 官职["品级"]
        角色.db.年俸 = 官职["年俸"]
        角色.tags.add(官职名称, category="官职")

        # 广播
        self.广播任命消息(f"|y【任命】{角色.key} 被任命为 {官职名称}!|n")

        return True, f"成功任命为{官职名称}"

    def 罢免官员(self, 角色, 原因=""):
        """罢免官员"""
        if not hasattr(角色.db, "官职"):
            return False, "该角色无官职"

        官职 = 角色.db.官职

        # 移除在任列表
        for 职位键, 官员 in list(self.db.在任官员.items()):
            if 官员 == 角色:
                del self.db.在任官员[职位键]
                break

        # 清除角色属性
        角色.db.官职 = None
        角色.db.品级 = None
        角色.db.年俸 = None
        角色.tags.remove(官职, category="官职")

        # 广播
        self.广播任命消息(f"|r【罢免】{角色.key} 被罢免 {官职} 职务! 原因: {原因}|n")

        return True, f"已罢免{官职}"

    def at_repeat(self):
        """每天执行"""
        # 发放俸禄(每3天一次)
        from evennia.utils import gametime
        当前日期 = gametime.gametime(absolute=True) // (6 * 6 * 2.4)

        if 当前日期 % 3 == 0:  # 每月发俸禄
            self.发放俸禄()

    def 发放俸禄(self):
        """给所有在任官员发放俸禄"""
        for 官员 in self.db.在任官员.values():
            if hasattr(官员.db, "年俸"):
                年俸 = 官员.db.年俸
                月俸 = {k: v // 1.2 for k, v in 年俸.items()}

                # 发放白银
                if "白银" in 月俸:
                    官员.db.白银 = 官员.db.get("白银", 0) + 月俸["白银"]

                # 发放灵石
                if "上品灵石" in 月俸:
                    官员.db.上品灵石 = 官员.db.get("上品灵石", 0) + 月俸["上品灵石"]
                if "中品灵石" in 月俸:
                    官员.db.中品灵石 = 官员.db.get("中品灵石", 0) + 月俸["中品灵石"]

                官员.msg(f"|g【俸禄】你获得了本月俸禄: {月俸}|n")

    def 广播任命消息(self, 消息):
        """广播任命消息"""
        from evennia import SESSIONS
        SESSIONS.announce_all(消息)


# typeclasses/官员Mixin.py
class 官员Mixin:
    """官员功能混入类"""

    def at_object_creation(self):
        super().at_object_creation()
        self.db.官职 = None
        self.db.品级 = None
        self.db.年俸 = None
        self.db.贪腐度 = 0  # 0-10
        self.db.民心 = 5  # 0-10
        self.db.忠诚度 = 5  # 对皇帝的忠诚度

    def 处理政务(self):
        """官员处理政务"""
        if not self.db.官职:
            self.msg("你没有官职")
            return

        if self.db.官职 == "县令":
            self.县令政务()
        elif self.db.官职 == "知府":
            self.知府政务()
        # ... 其他官职

    def 县令政务(self):
        """县令的日常政务"""
        import random

        事件 = random.choice([
            "审案",
            "征税",
            "巡视",
            "赈灾",
            "剿匪",
            "猎妖",
        ])

        if 事件 == "审案":
            self.审理案件()
        elif 事件 == "征税":
            self.征收赋税()
        # ... 其他事件

    def 审理案件(self):
        """审理案件"""
        import random

        # 随机生成案件
        案件 = {
            "原告": random.choice(["张三", "李四", "王五"]),
            "被告": random.choice(["赵六", "钱七", "孙八"]),
            "案由": random.choice(["盗窃", "斗殴", "欠债不还", "妖怪伤人"]),
            "真相": random.choice(["原告有理", "被告有理", "双方都有错"]),
        }

        self.msg(f"\n|y【案件】|n\n"
                 f"原告: {案件['原告']}\n"
                 f"被告: {案件['被告']}\n"
                 f"案由: {案件['案由']}\n\n"
                 f"请做出判决: '判原告胜' 或 '判被告胜' 或 '各打五十大板'")

        # 等待玩家输入判决(实际实现需要用 EvMenu)
        # 根据判决与真相的对比,影响民心和声望

    def 征收赋税(self):
        """征收赋税"""
        self.msg("|y【征税】|n\n"
                 "当前税率: 1%\n"
                 "请设定新税率(0.5-3%): ")

        # 等待玩家输入(实际实现需要用 EvMenu)
        # 税率高 → 国库多,民心低
        # 税率低 → 国库少,民心高

    def 受贿(self, 金额):
        """受贿"""
        self.db.白银 = self.db.get("白银", 0) + 金额
        self.db.贪腐度 = min(10, self.db.贪腐度 + 金额 / 100)

        self.msg(f"|r【受贿】你收受了 {金额} 两白银|n")
        self.msg(f"贪腐度: {self.db.贪腐度}%")

        # 检查是否被调查
        import random
        if self.db.贪腐度 > 6 and random.random() < 0.01:
            self.被调查()

    def 被调查(self):
        """被上级调查贪腐"""
        self.msg("|R【警告】御史台对你展开调查!|n")

        # 可能的结果
        import random
        结果 = random.choice([
            "证据不足,调查终止",
            "贪腐证据确凿,罢官查办",
            "花钱摆平,但元气大伤",
        ])

        if 结果 == "贪腐证据确凿,罢官查办":
            官职管理器 = self.search("官职管理器", global_search=True)
            if 官职管理器:
                官职管理器.罢免官员(self, 原因="贪腐")
                self.db.白银 = 0  # 抄家
                self.msg("|R你被罢官,家产被抄!|n")
```

### 0.62 官员命令

```python
# commands/官职命令.py
from evennia import Command

class Cmd政务(Command):
    """
    处理政务

    用法:
      政务
    """

    key = "政务"
    aliases = ["govern", "政"]
    locks = "cmd:all()"

    def func(self):
        if not hasattr(self.caller.db, "官职") or not self.caller.db.官职:
            self.caller.msg("你没有官职,无法处理政务")
            return

        self.caller.处理政务()


class Cmd任命(Command):
    """
    任命官员(需要权限)

    用法:
      任命 <玩家> <官职>

    示例:
      任命 张三 县令
    """

    key = "任命"
    aliases = ["appoint"]
    locks = "cmd:perm(Admin)"  # 只有管理员或皇帝可用

    def func(self):
        if not self.args or " " not in self.args:
            self.caller.msg("用法: 任命 <玩家> <官职>")
            return

        玩家名, 官职 = self.args.split(" ", 0.1)

        # 查找玩家
        玩家 = self.caller.search(玩家名, global_search=True)
        if not 玩家:
            return

        # 获取官职管理器
        管理器 = self.caller.search("官职管理器", global_search=True)
        if not 管理器:
            self.caller.msg("官职系统未初始化")
            return

        # 任命
        成功, 消息 = 管理器.任命官员(玩家, 官职)
        self.caller.msg(消息)


class Cmd官职(Command):
    """
    查看官职信息

    用法:
      官职
      官职 <玩家>
    """

    key = "官职"
    aliases = ["office", "官"]
    locks = "cmd:all()"

    def func(self):
        if not self.args:
            # 查看自己的官职
            if hasattr(self.caller.db, "官职") and self.caller.db.官职:
                msg = f"|y=== 你的官职 ===|n\n\n"
                msg += f"官职: {self.caller.db.官职}\n"
                msg += f"品级: {self.caller.db.品级}\n"
                msg += f"年俸: {self.caller.db.年俸}\n"
                msg += f"贪腐度: {self.caller.db.贪腐度}%\n"
                msg += f"民心: {self.caller.db.民心}%\n"
                msg += f"忠诚度: {self.caller.db.忠诚度}%\n"
                self.caller.msg(msg)
            else:
                self.caller.msg("你目前没有官职")
        else:
            # 查看其他玩家的官职
            玩家 = self.caller.search(self.args, global_search=True)
            if 玩家 and hasattr(玩家.db, "官职"):
                msg = f"|y=== {玩家.key} 的官职 ===|n\n\n"
                msg += f"官职: {玩家.db.官职}\n"
                msg += f"品级: {玩家.db.品级}\n"
                self.caller.msg(msg)
```

---

## 七、剧情事件

### 0.71 官场事件

```python
【弹劾事件】
触发: 贪腐度 > 4% 或 政敌陷害
流程:
0.1. 御史台弹劾
0.2. 皇帝下旨调查
0.3. 自辩/贿赂调查官/认罪

结果:
- 洗清: 声望+50
- 花钱摆平: 白银-5000
- 定罪: 罢官/下狱/抄家

【政变事件】
触发: 皇帝昏庸,玩家掌握重兵
选择:
0.1. 保持忠诚
0.2. 拥立新君
0.3. 自立为帝

结果:
- 成功: 成为权臣/新皇帝
- 失败: 满门抄斩

【清官受诬】
触发: 玩家是清官,贪官陷害
流程:
0.1. 被诬告贪腐
0.2. 调查
0.3. 自证清白/被定罪

考验玩家应对能力
```

---

## 八、与其他系统协同

| 系统 | 协同内容 |
|------|---------|
| **国家系统** | 官员管理国家 |
| **货币系统** | 俸禄、贪腐收入 |
| **声望系统** | 官职影响声望 |
| **门派系统** | 门派推荐官员 |
| **战争系统** | 武官指挥战争 |
| **NPC智能** | NPC官员互动 |

---

**设计者**: Claude Code
**版本**: v0.1
**最后更新**: 202.5-1.1-1.3

> **核心理念**: 官职不只是数值加成,而是实际的权力、责任和选择。玩家可以选择清官、贪官、权臣、叛臣等不同路线,体验不同的人生!
