# 修仙游戏装备系统设计方案

> 基于经典修仙小说（凡人修仙传）和修仙游戏的法宝装备设定
>
> **重要**: 本文档为装备品阶唯一数据源,其他系统应引用本文档的装备分类
>
> **依赖系统**: 境界系统(境界与装备对应)、货币系统(装备价格)、炼器系统(装备制作)
>
> **参考标准**: 详见《【重要】文档统一标准.md》

---

## 一、装备系统概述

### 1.1 什么是法宝装备？

在修仙世界中，**法宝**（又称法器、灵器）是修士用来战斗、修炼、护身的器物。与凡间兵器不同，法宝需要用灵力催动，拥有各种神奇功效。

### 1.2 装备系统特点

- **等阶分明**: 从凡器到仙器，层层递进
- **需要炼化**: 法宝需要认主和炼化才能使用
- **可以成长**: 通过强化、进阶提升品质
- **器灵系统**: 高级法宝可诞生器灵
- **套装效果**: 成套法宝有额外加成
- **寿命限制**: 法宝有耐久度，需要修复

### 1.3 装备与境界的关系

> **数据源**: 详见《【重要】文档统一标准.md》- 装备品阶统一标准表

| 境界 | 适用装备品阶 | 备注 |
|------|------------|------|
| 练气期(1-13层) | 0阶凡器、1阶法器 | 初学者装备 |
| 筑基期(初/中/后/圆满) | 2阶灵器 | 正式踏入修仙之路 |
| 金丹期(初/中/后/圆满) | 3阶宝器 | 开始使用宝器 |
| 元婴期(初/中/后/圆满) | 4阶灵宝 | 灵宝为主 |
| 化神期(初/中/后/圆满) | 5阶通天灵宝 | 通天灵宝 |
| 炼虚期(初/中/后/圆满) | 6阶仙器(下品) | 仙器下品 |
| 合体期(初/中/后/圆满) | 7阶仙器(中品) | 仙器中品 |
| 大乘期(初/中/后/圆满) | 8阶仙器(上品) | 仙器上品 |
| 渡劫期(1-9劫) | 9阶先天灵宝 | 人界顶点 |

---

## 二、装备等阶体系 (统一标准)

> **重要**: 本章节数据引用自《【重要】文档统一标准.md》,所有系统必须遵守统一标准
>
> **唯一数据源**: 《【重要】文档统一标准.md》第一章 - 装备品阶统一标准

### 2.1 装备品阶标准表

| 品阶 | 名称 | 适用境界 | 价格范围(灵石) | 颜色标识 | 示例 |
|------|------|---------|---------------|---------|------|
| **0阶** | 凡器 | 凡人-练气初期 | 1-100银两 | 灰色 | 凡铁剑、精钢刀 |
| **1阶** | 法器 | 练气期(1-13层) | 10-1000下品 | 白色 | 青钢剑、灵木盾 |
| **2阶** | 灵器 | 筑基期 | 100-10000下品(1-100中品) | 绿色 | 紫霄剑、玄铁盾 |
| **3阶** | 宝器 | 金丹期 | 1000-100000下品(1-100上品) | 蓝色 | 翻天印、紫金钵 |
| **4阶** | 灵宝 | 元婴期 | 1-100极品 | 紫色 | 七星剑、混元珠 |
| **5阶** | 通天灵宝 | 化神期 | 1-100灵晶 | 金色 | 轩辕剑碎片 |
| **6阶** | 仙器(下品) | 炼虚期 | 100-1000灵晶 | 橙色 | 开天斧 |
| **7阶** | 仙器(中品) | 合体期 | 1000-10000灵晶 | 红色 | 混沌钟 |
| **8阶** | 仙器(上品) | 大乘期 | 10000-100000灵晶 | 七彩 | 太极图 |
| **9阶** | 先天灵宝 | 渡劫期及以上 | 无价 | 璀璨 | 诛仙剑、盘古幡 |

### 2.2 品阶详细说明

#### 0阶 - 凡器（凡人兵器）
- **特点**: 无需灵力,纯物理武器
- **属性**: 攻击+1~2
- **获取**: 铁匠铺购买/凡人任务奖励

#### 1阶 - 法器（入门修仙装备）
- **特点**: 需灵力催动,有简单灵力增幅
- **属性**: 攻击+2~10
- **获取**: 门派兑换/坊市购买/炼器师制作

#### 2阶 - 灵器（筑基主流装备）
- **特点**: 天地灵气孕育,威力巨大
- **属性**: 攻击+10~50
- **特殊**: 极品可能诞生器灵
- **获取**: 拍卖会/秘境掉落/高级炼器师制作

#### 3阶 - 宝器（金丹主流装备）
- **特点**: 凝结金丹才能发挥全部威力
- **属性**: 攻击+50~200
- **特殊**: 30%概率诞生器灵
- **获取**: 遗迹/拍卖会/顶级炼器师制作

#### 4阶 - 灵宝（元婴顶级装备）
- **特点**: 元婴修士本命法宝
- **属性**: 攻击+200~500
- **特殊**: 60%概率诞生器灵
- **获取**: 上古遗迹/仙府/机缘/炼器宗师制作

#### 5阶 - 通天灵宝（化神期装备）
- **特点**: 通天彻地之宝,威力巨大
- **属性**: 攻击+200~800
- **特殊**: 60%概率诞生器灵
- **获取**: 上古遗迹/仙府/机缘/炼器宗师制作

#### 6-8阶 - 仙器（炼虚以上装备）
- **特点**: 仙界之物,威力巨大
- **属性**: 攻击+800~3000
- **特殊**: 必有器灵
- **获取**: 飞升前辈遗留/上界掉落/渡劫奖励

#### 9阶 - 先天灵宝（人界顶点）
- **特点**: 人界最强,近乎无敌
- **属性**: 攻击+3000~10000
- **特殊**: 强大器灵,自带领域
- **获取**: 唯一性,剧情获得

### 2.2 品阶细分

每个大等阶内部又分为品阶：

```
下品 < 中品 < 上品 < 极品（完美品）
```

**品阶影响**:
- 基础属性差距：30%~50%
- 特效数量：下品1个，中品2个，上品3个，极品4个
- 升级潜力：品阶越高，强化上限越高
- 器灵概率：极品法宝更容易诞生器灵

---

## 三、装备类型

### 3.1 按用途分类

#### 1. 武器类（攻击）⚔️

**剑类**:
- **飞剑**: 修士最常用武器，可御剑飞行
  - 单剑：青锋剑、紫霄剑
  - 剑阵：七星剑阵、万剑归宗（72柄）
- **巨剑**: 力量型，威力大但笨重
- **双剑**: 灵活，攻速快

**刀类**:
- **长刀**: 霸道凶猛
- **短刀**: 灵活刁钻
- **血刀**: 魔道专用，吸血

**其他武器**:
- **枪/矛**: 破甲能力强
- **鞭**: 灵活多变
- **扇**: 法修专用，可施法
- **琴**: 音攻法器
- **笔**: 符修专用
- **斧/锤**: 力量型
- **钩/爪**: 刺客型

#### 2. 护甲类（防御）🛡️

**护身法衣**:
- **道袍**: 基础防御+灵力恢复
- **灵甲**: 高防御
- **战甲**: 体修专用，极高防御
- **法袍**: 法修专用，增强法术

**护盾法器**:
- **盾牌**: 物理防御
- **护罩**: 灵力护罩，全方位防御
- **铠甲**: 贴身防御

**头盔/帽子**:
- **道冠**: 增加神识
- **战盔**: 增加防御
- **斗笠**: 隐藏身份+防御

**靴子**:
- **风行靴**: 增加速度
- **云履**: 可飞行
- **战靴**: 增加力量

**手套/护腕**:
- **灵力手套**: 增加攻击
- **护腕**: 增加防御
- **符手套**: 施法速度+

#### 3. 饰品类（辅助）💎

**戒指**:
- **储物戒**: 空间法宝，存放物品
- **护身戒**: 自动防御
- **灵力戒**: 增加真元上限

**项链/吊坠**:
- **护心坠**: 保护心脉
- **灵玉佩**: 增加灵根资质
- **避毒珠**: 免疫毒素

**腰带**:
- **灵力腰带**: 增加真元
- **储物袋**: 空间法宝

**其他饰品**:
- **玉简**: 记录功法或信息
- **罗盘**: 寻宝、导航
- **铃铛**: 警示、音攻

#### 4. 特殊类（功能）🔮

**炼丹炉**:
- 用于炼制丹药
- 品质影响成丹率

**炼器炉**:
- 用于炼制法器
- 品质影响成器率

**阵盘**:
- 布置阵法的核心
- 困敌、杀敌、防御

**傀儡**:
- 可操控的战斗傀儡
- 替身、助战

**灵兽袋**:
- 存放灵兽
- 提供灵兽生存环境

**传送符**:
- 一次性逃生道具
- 随机传送

### 3.2 装备部位

玩家可装备的部位：

```
1. 主武器（右手）
2. 副武器/盾牌（左手）
3. 头部（头盔/道冠）
4. 身体（道袍/灵甲）
5. 腿部（裤子/战裙）
6. 脚部（靴子/云履）
7. 手部（手套/护腕）
8. 饰品1（戒指）
9. 饰品2（戒指）
10. 饰品3（项链）
11. 饰品4（腰带）
12. 特殊（储物戒）
```

总计：12个装备栏

---

## 四、装备属性系统

### 4.1 基础属性

**攻击属性**:
- **物理攻击**: 增加物理伤害
- **法术攻击**: 增加法术伤害
- **攻击速度**: 提高攻击频率
- **暴击率**: 增加暴击概率
- **暴击伤害**: 增加暴击倍数

**防御属性**:
- **物理防御**: 减少物理伤害
- **法术防御**: 减少法术伤害
- **闪避率**: 增加闪避概率
- **格挡值**: 格挡伤害

**生存属性**:
- **最大气血**: 增加生命值上限
- **最大真元**: 增加真元上限
- **气血恢复**: 每秒恢复气血
- **真元恢复**: 每秒恢复真元

**其他属性**:
- **移动速度**: 增加移动速度
- **神识强度**: 增加神识范围和强度
- **气运**: 增加掉落和机缘概率
- **全属性**: 增加所有基础属性

### 4.2 特殊效果（词条）

**攻击特效**:
- **破甲**: 无视目标X%防御
- **吸血**: 造成伤害的X%转化为生命
- **溅射**: 攻击溅射到周围敌人
- **连击**: 有X%概率触发连击
- **追击**: 攻击后追加X%伤害

**防御特效**:
- **格挡**: X%概率格挡攻击
- **反伤**: 反弹X%受到的伤害
- **减伤**: 减少X%受到的伤害
- **免疫**: 免疫某种元素伤害
- **护盾**: 受到攻击时产生护盾

**元素特效**:
- **火焰附加**: 攻击附带火焰伤害
- **冰冻附加**: 攻击有概率冰冻敌人
- **雷电附加**: 攻击附带雷电伤害，可链式攻击
- **毒素附加**: 攻击造成持续中毒
- **元素强化**: 增强X元素伤害

**功能特效**:
- **经验加成**: 增加X%获得的经验
- **掉落加成**: 增加X%物品掉落率
- **修炼加成**: 修炼速度+X%
- **技能冷却**: 减少技能冷却时间
- **真元节省**: 技能消耗-X%

### 4.3 属性示例

**下品法器：青钢剑**
```
等阶：法器（下品）
需求：练气3层
基础属性：
  物理攻击：+4
  攻击速度：+5%
特殊效果：
  [锋锐]：无视1点防御
耐久度：100/100
```

**上品灵器：紫霄剑**
```
等阶：灵器（上品）
需求：金丹期
基础属性：
  物理攻击：+28
  法术攻击：+15
  暴击率：+10%
特殊效果：
  [雷霆一击]：攻击附带雷电伤害，造成额外50%伤害
  [御剑飞行]：可御剑飞行，飞行速度+50%
  [剑气纵横]：普通攻击发出剑气，攻击距离+5米
强化等级：+7
耐久度：500/500
```

**极品法宝：七星剑（套装）**
```
等阶：法宝（极品）
需求：化神期
套装：七星剑阵（1/7）
基础属性：
  物理攻击：+85
  法术攻击：+62
  全属性：+5
  暴击率：+20%
  暴击伤害：+80%
特殊效果：
  [星辰之力]：攻击附带星辰之力，伤害+30%
  [七星连珠]：七连击，每击伤害递增10%
  [剑阵共鸣]：拥有越多七星剑，威力越强
  [器灵觉醒]：拥有器灵"星灵"，可独立战斗
套装效果（1件）：
  全属性+10%
套装效果（3件）：
  剑类技能伤害+30%
套装效果（7件）：
  解锁终极技"七星剑阵"，毁天灭地
强化等级：+15
器灵等级：5级
耐久度：2000/2000
品质：完美
```

---

## 五、装备获取方式

### 5.1 获取途径

#### 1. 商店购买
- **凡人商铺**: 凡器、下品法器
- **修仙坊市**: 中品法器、上品法器
- **门派兑换**: 用贡献度兑换门派法宝
- **拍卖行**: 稀有法宝拍卖

#### 2. 打怪掉落
- **普通妖兽**: 掉落凡器、法器
- **精英妖兽**: 掉落灵器
- **BOSS**: 掉落高级灵器、法宝
- **世界BOSS**: 掉落极品法宝、通天灵宝

#### 3. 任务奖励
- **主线任务**: 固定装备奖励
- **支线任务**: 随机装备奖励
- **门派任务**: 门派特色装备
- **国家任务**: 国家专属装备

#### 4. 机缘获得
- **洞府探索**: 前辈遗留法宝
- **秘境试炼**: 通关奖励
- **天降异宝**: 极低概率天降
- **古战场**: 搜寻古代法宝

#### 5. 自己炼制
- **炼器**: 收集材料自己炼制
- **委托炼制**: 找炼器师帮忙炼制
- **门派炼器**: 使用门派炼器房

#### 6. 交易获得
- **玩家交易**: 与其他玩家交易
- **商人购买**: 向NPC商人购买
- **黑市**: 黑市可能有违禁品

---

## 六、装备强化系统

### 6.1 装备强化

#### 强化规则
- 消耗灵石和强化材料
- 每次强化+1级，增加属性
- 强化有成功率，失败不掉级但损失材料
- 强化等级上限 = 装备等阶×5
  - 法器：最高+15
  - 灵器：最高+20
  - 法宝：最高+25

#### 强化成功率

| 强化等级 | 成功率 | 消耗 |
|---------|--------|------|
| +1~+5 | 100% | 少量灵石 |
| +6~+10 | 80% | 中量灵石+强化石 |
| +11~+15 | 60% | 大量灵石+高级强化石 |
| +16~+20 | 40% | 海量灵石+极品强化石 |
| +21~+25 | 20% | 天价灵石+天材地宝 |

#### 强化收益
每+1级：
- 基础属性+5%
- 特殊效果强度+2%

#### 保护机制
- **强化保护符**: 失败不损失强化等级
- **必成符**: 100%成功（限+10以下）

### 6.2 装备进阶

#### 进阶规则
- 法器可进阶为灵器
- 灵器可进阶为法宝
- 需要大量材料和特殊条件

#### 进阶条件

**法器→灵器**:
- 强化等级达到+15
- 消耗：灵核×10，灵晶×100，灵石×1000
- 成功率：50%
- 失败：掉回+10

**灵器→法宝**:
- 强化等级达到+20
- 消耗：法宝碎片×5，天材地宝×1，灵石×10000
- 成功率：30%
- 失败：掉回+15

### 6.3 装备重铸

#### 重铸系统
- 重新随机装备的特殊效果（词条）
- 保留基础属性和强化等级
- 消耗重铸石

#### 词条洗练
- 锁定部分词条，重铸其他词条
- 消耗更多重铸石

---

## 七、器灵系统

### 7.1 器灵诞生

#### 诞生条件
- **装备等阶**: 极品灵器以上
- **强化等级**: +15以上
- **使用时间**: 使用满1年（游戏时间）
- **灵气滋养**: 注入灵气达到100000点
- **概率**: 基础概率1%，可通过特殊方法提升

#### 诞生方式

**自然诞生**:
- 长时间使用，自然产生灵性
- 概率低，但器灵品质高

**主动孕育**:
- 使用妖兽魂魄+灵气灌注
- 概率高，但器灵品质看运气

**高人点化**:
- 找元婴期以上高人点化
- 100%成功，品质看高人实力

### 7.2 器灵属性

#### 器灵等级
- 1级~10级
- 每级增加装备属性10%
- 消耗灵气升级

#### 器灵技能

**被动技能**:
- **灵力增幅**: 增加主人灵力10%
- **自动防御**: 危险时自动防御
- **灵气恢复**: 增加灵气恢复速度

**主动技能**:
- **器灵化形**: 器灵化为实体协同作战
- **灵魂链接**: 器灵与主人心意相通
- **法宝自修**: 器灵可自行修复法宝

#### 器灵性格
- **忠诚型**: 绝对服从主人
- **傲娇型**: 偶尔闹脾气，但关键时刻靠谱
- **活泼型**: 话多，但能力强
- **沉默型**: 不说话，默默守护
- **叛逆型**: 需要培养忠诚度，否则可能反噬

### 7.3 器灵养成

#### 喂养系统
- 喂食灵药、灵石提升经验
- 喂食特殊材料学习新技能
- 喂食同属性材料增强属性

#### 亲密度系统
- 使用法宝战斗增加亲密度
- 亲密度影响器灵配合度
- 低亲密度器灵可能不听话

#### 器灵进化
- 达到10级后可进化
- 进化需要特殊材料
- 进化后外观和能力大幅提升

---

## 八、套装系统

### 8.1 套装概念

多件同系列装备穿戴后，激活套装效果。

#### 套装示例

**七星剑阵（7件套）**:
- 七把飞剑：天枢、天璇、天玑、天权、玉衡、开阳、摇光
- 2件套效果：剑系技能伤害+15%
- 4件套效果：剑系技能伤害+30%，攻速+20%
- 7件套效果：解锁终极技"七星剑阵"，群体毁灭技能

**玄武战甲（4件套）**:
- 玄武盔、玄武甲、玄武靴、玄武盾
- 2件套效果：最大气血+20%
- 4件套效果：最大气血+40%，受到伤害-20%，解锁技能"玄武护体"

**凤凰羽衣（5件套）**:
- 凤冠、凤袍、凤履、凤佩、凤钗
- 2件套效果：法术攻击+20%
- 3件套效果：法术攻击+35%，施法速度+15%
- 5件套效果：法术攻击+60%，施法速度+30%，解锁技能"浴火重生"（死亡后复活一次）

### 8.2 套装获取

- **副本产出**: 特定副本掉落套装
- **BOSS掉落**: 世界BOSS掉落
- **兑换**: 用特殊货币兑换
- **炼制**: 获得图纸后炼制

---

## 九、装备炼化与认主

### 9.1 装备绑定机制

#### 未绑定状态
- 刚获得的装备为未绑定
- 可以自由交易

#### 绑定状态
- **装备绑定**: 穿戴后绑定，无法交易
- **拾取绑定**: 拾取即绑定
- **炼化绑定**: 炼化后绑定

### 9.2 炼化系统

#### 炼化作用
- 提高法宝契合度
- 解锁法宝全部威力
- 建立心神联系

#### 炼化等级

| 炼化层数 | 效果 | 时间消耗 |
|---------|------|---------|
| 第1层 | 基础使用，发挥30%威力 | 1小时 |
| 第2层 | 发挥50%威力 | 3小时 |
| 第3层 | 发挥70%威力 | 6小时 |
| 第4层 | 发挥85%威力 | 12小时 |
| 第5层 | 发挥100%威力 | 24小时 |
| 第6层+ | 超越极限，属性+5%/层 | 48小时/层 |

#### 炼化方法
- **打坐炼化**: 消耗时间，最稳妥
- **战斗炼化**: 使用法宝战斗，快速提升契合度
- **灵气灌注**: 消耗灵石，快速炼化

### 9.3 本命法宝

#### 本命法宝特点
- 修士亲手炼制或认主的法宝
- 与修士性命相连
- 法宝强，修士强；法宝损，修士伤

#### 本命法宝优势
- 威力提升50%
- 心念相通，指挥如臂
- 可随境界成长
- 损坏可用修为修复

#### 本命法宝限制
- 每人只能有1件本命法宝
- 法宝损坏，修士受重创
- 法宝被毁，修士境界跌落

---

## 十、装备耐久与修复

### 10.1 耐久度系统

#### 耐久度规则
- 所有装备都有耐久度
- 战斗、使用消耗耐久度
- 耐久度归零，装备无法使用

#### 耐久度消耗

| 活动 | 消耗 |
|------|------|
| 普通战斗 | -1/场 |
| 精英战斗 | -3/场 |
| BOSS战 | -5/场 |
| 被破坏性攻击击中 | -10 |
| 死亡 | -20 |

### 10.2 装备修复

#### 修复方式

**NPC修理**:
- 找修理师修复
- 消耗灵石
- 修复速度快

**自己修复**:
- 需要炼器技能
- 消耗材料
- 成本低但需要时间

**完美修复**:
- 找高级炼器师
- 消耗大量灵石和材料
- 恢复到完美状态，甚至提升品质

#### 修复成本

```
修复成本 = (最大耐久度 - 当前耐久度) × 装备等阶系数 × 品阶系数
```

示例：
- 下品法器修满：10灵石
- 上品灵器修满：100灵石
- 极品法宝修满：1000灵石

---

## 十一、特殊装备

### 11.1 成长型装备

#### 特点
- 可随玩家境界成长
- 等阶会自动提升
- 通常是剧情奖励

#### 示例：青竹蜂云剑
```
初始：下品法器（练气期）
成长1：中品法器（筑基期）
成长2：上品法器（金丹期）
成长3：下品灵器（元婴期）
...
最终：通天灵宝（大乘期）
```

### 11.2 特殊功能装备

#### 储物装备
- **储物袋**: 10格，容量100
- **储物戒**: 30格，容量1000
- **空间手镯**: 100格，容量10000
- **芥子空间**: 无限格，容量无限（极稀有）

#### 飞行装备
- **飞行法器**: 飞剑、飞舟、飞毯
- **速度**: 根据等阶和玩家境界
- **续航**: 消耗真元，需要休息

#### 变化装备
- **易容面具**: 改变外貌
- **隐身斗篷**: 短时间隐身
- **变身符**: 变成他人模样

#### 探测装备
- **寻宝罗盘**: 探测宝物
- **望气镜**: 查看他人修为
- **天机盘**: 推演吉凶

### 11.3 消耗型装备

#### 符箓
- **攻击符**: 一次性攻击（火球符、雷霆符）
- **防御符**: 一次性防御（护盾符、金刚符）
- **辅助符**: 一次性辅助（疾行符、隐身符）
- **传送符**: 一次性传送（遁空符）

#### 丹药（算半装备）
- 虽然是消耗品，但在战斗中很重要
- 可以提前准备在快捷栏

#### 阵盘
- 一次性或多次使用
- 布置各种阵法
- 困敌、杀敌、防御

---

## 十二、装备交易系统

### 12.1 交易方式

#### 玩家交易
- 面对面交易
- 摆摊交易
- 拍卖行交易

#### NPC交易
- 商店购买
- 任务兑换
- 贡献度兑换

### 12.2 装备估价

#### 价格因素
- **等阶**: 法器<灵器<法宝
- **品阶**: 下品<中品<上品<极品
- **强化等级**: +1~+25
- **词条**: 特殊效果越好越贵
- **耐久度**: 耐久度低会贬值
- **是否有器灵**: 有器灵大幅增值

#### 价格示例
- 下品法器：10~50灵石
- 中品法器：50~200灵石
- 上品法器：200~1000灵石
- 下品灵器：1000~5000灵石
- 中品灵器：5000~20000灵石
- 上品灵器：20000~100000灵石
- 下品法宝：100000+灵石

---

## 十三、数据结构设计

### 13.1 装备数据类

```gdscript
class_name 装备数据

# 基础信息
var 装备ID: String
var 装备名称: String
var 装备类型: String  # "武器"/"护甲"/"饰品"/"特殊"
var 装备部位: String  # "主武器"/"头部"/"饰品1"等
var 装备图标: Texture

# 等阶品质
var 装备等阶: String  # "凡器"/"法器"/"灵器"/"法宝"
var 品阶: String      # "下品"/"中品"/"上品"/"极品"
var 品质颜色: Color   # 白/绿/蓝/紫/橙/金

# 需求
var 需求境界: int = 1      # 需要的境界等级
var 需求属性: Dictionary = {}  # {"力量": 10}

# 基础属性
var 物理攻击: int = 0
var 法术攻击: int = 0
var 物理防御: int = 0
var 法术防御: int = 0
var 最大气血: int = 0
var 最大真元: int = 0
var 其他属性: Dictionary = {}  # 其他属性

# 特殊效果（词条）
var 特殊效果列表: Array = []  # 词条数组

# 强化系统
var 强化等级: int = 0
var 最大强化等级: int = 15
var 强化加成倍率: float = 0.05  # 每级+5%

# 炼化系统
var 炼化层数: int = 0
var 最大炼化层数: int = 9
var 契合度: float = 0.0  # 0.0~1.0

# 器灵系统
var 是否有器灵: bool = false
var 器灵数据: 器灵数据 = null

# 套装系统
var 套装ID: String = ""
var 套装序号: int = 0  # 第几件

# 耐久度
var 当前耐久度: int = 100
var 最大耐久度: int = 100

# 绑定状态
var 是否绑定: bool = false
var 绑定类型: String = ""  # "装备绑定"/"拾取绑定"

# 其他
var 描述: String = ""
var 来源: String = ""
var 是否可交易: bool = true
var 是否可强化: bool = true
var 是否可进阶: bool = true

func 获取最终属性() -> Dictionary:
	"""计算强化、炼化后的最终属性"""
	var 最终属性 = {}

	# 基础属性
	var 基础加成 = 1.0 + (强化等级 * 强化加成倍率)
	var 炼化加成 = 炼化层数 * 0.05  # 每层+5%

	最终属性["物理攻击"] = int(物理攻击 * 基础加成 * (1.0 + 炼化加成))
	最终属性["法术攻击"] = int(法术攻击 * 基础加成 * (1.0 + 炼化加成))
	最终属性["物理防御"] = int(物理防御 * 基础加成 * (1.0 + 炼化加成))
	最终属性["法术防御"] = int(法术防御 * 基础加成 * (1.0 + 炼化加成))

	# 器灵加成
	if 是否有器灵 and 器灵数据:
		var 器灵加成 = 器灵数据.等级 * 0.1  # 每级+10%
		for 属性名 in 最终属性:
			最终属性[属性名] *= (1.0 + 器灵加成)

	return 最终属性

func 损耗耐久度(损耗值: int):
	"""损耗耐久度"""
	当前耐久度 = max(0, 当前耐久度 - 损耗值)

	if 当前耐久度 == 0:
		# 耐久度耗尽，装备失效
		pass

func 修复耐久度(修复值: int):
	"""修复耐久度"""
	当前耐久度 = min(最大耐久度, 当前耐久度 + 修复值)

func 强化():
	"""强化装备"""
	if 强化等级 >= 最大强化等级:
		return false

	# 强化逻辑
	强化等级 += 1
	return true

func 炼化():
	"""炼化装备"""
	if 炼化层数 >= 最大炼化层数:
		return false

	炼化层数 += 1
	契合度 = 炼化层数 / float(最大炼化层数)
	return true
```

### 13.2 器灵数据类

```gdscript
class_name 器灵数据

var 器灵名字: String = ""
var 器灵性别: String = "无"
var 器灵性格: String = "忠诚型"
var 器灵等级: int = 1
var 器灵经验: int = 0

# 亲密度
var 亲密度: int = 0  # 0~100

# 技能
var 被动技能列表: Array = []
var 主动技能列表: Array = []

# 外观
var 器灵形态: String = "灵体"  # "灵体"/"化形"

func 升级():
	"""器灵升级"""
	if 器灵经验 >= 需要经验():
		器灵经验 -= 需要经验()
		器灵等级 += 1
		学习新技能()

func 需要经验() -> int:
	return 器灵等级 * 1000

func 学习新技能():
	"""等级提升时学习新技能"""
	pass

func 化形战斗():
	"""器灵化形协助战斗"""
	if 器灵等级 >= 5:
		# 可以化形
		pass
```

### 13.3 装备管理器

```gdscript
class_name 装备管理器

# 玩家当前装备
var 当前装备: Dictionary = {
	"主武器": null,
	"副武器": null,
	"头部": null,
	"身体": null,
	"腿部": null,
	"脚部": null,
	"手部": null,
	"饰品1": null,
	"饰品2": null,
	"饰品3": null,
	"饰品4": null,
	"储物": null
}

signal 装备改变(部位, 新装备)

func 穿戴装备(装备: 装备数据, 部位: String) -> bool:
	"""穿戴装备"""

	# 检查需求
	if not 检查装备需求(装备):
		return false

	# 卸下旧装备
	if 当前装备[部位]:
		卸下装备(部位)

	# 穿戴新装备
	当前装备[部位] = 装备
	装备.是否绑定 = true

	# 更新属性
	更新玩家属性()

	装备改变.emit(部位, 装备)
	return true

func 卸下装备(部位: String) -> 装备数据:
	"""卸下装备"""
	var 装备 = 当前装备[部位]
	当前装备[部位] = null

	# 更新属性
	更新玩家属性()

	装备改变.emit(部位, null)
	return 装备

func 检查装备需求(装备: 装备数据) -> bool:
	"""检查是否满足装备需求"""
	# 检查境界
	var 玩家境界 = 玩家.属性管理器.境界系统.获取境界等级()
	if 玩家境界 < 装备.需求境界:
		return false

	# 检查属性
	for 属性名 in 装备.需求属性:
		var 需求值 = 装备.需求属性[属性名]
		var 玩家值 = 玩家.属性管理器.基础属性.获取属性(属性名)
		if 玩家值 < 需求值:
			return false

	return true

func 更新玩家属性():
	"""根据装备更新玩家属性"""
	# 清空装备加成
	玩家.属性管理器.战斗属性.清空装备加成()

	# 重新计算所有装备加成
	for 部位 in 当前装备:
		var 装备 = 当前装备[部位]
		if 装备:
			var 最终属性 = 装备.获取最终属性()
			应用装备属性(最终属性)

	# 检查套装效果
	检查套装效果()

func 应用装备属性(属性: Dictionary):
	"""将装备属性应用到玩家"""
	for 属性名 in 属性:
		var 属性值 = 属性[属性名]
		玩家.属性管理器.战斗属性.增加装备属性(属性名, 属性值)

func 检查套装效果():
	"""检查是否激活套装效果"""
	var 套装统计 = {}

	# 统计套装件数
	for 部位 in 当前装备:
		var 装备 = 当前装备[部位]
		if 装备 and 装备.套装ID != "":
			if not 套装统计.has(装备.套装ID):
				套装统计[装备.套装ID] = 0
			套装统计[装备.套装ID] += 1

	# 应用套装效果
	for 套装ID in 套装统计:
		var 件数 = 套装统计[套装ID]
		应用套装效果(套装ID, 件数)

func 应用套装效果(套装ID: String, 件数: int):
	"""应用套装效果"""
	# 根据套装ID和件数应用对应效果
	pass

func 获取战力() -> int:
	"""计算装备战力"""
	var 总战力 = 0

	for 部位 in 当前装备:
		var 装备 = 当前装备[部位]
		if 装备:
			总战力 += 计算装备战力(装备)

	return 总战力

func 计算装备战力(装备: 装备数据) -> int:
	"""计算单件装备战力"""
	var 战力 = 0
	var 最终属性 = 装备.获取最终属性()

	# 简单公式
	战力 += 最终属性.get("物理攻击", 0) * 1.0
	战力 += 最终属性.get("法术攻击", 0) * 1.0
	战力 += 最终属性.get("物理防御", 0) * 0.5
	战力 += 最终属性.get("法术防御", 0) * 0.5
	战力 += 最终属性.get("最大气血", 0) * 0.1
	战力 += 最终属性.get("最大真元", 0) * 0.1

	# 器灵加成
	if 装备.是否有器灵:
		战力 *= 1.5

	return int(战力)
```

---

## 十四、实现建议

### 14.1 实现优先级

#### 第一阶段（核心功能）
1. 装备数据结构
2. 装备穿戴/卸下系统
3. 基础属性计算
4. 装备获取（掉落、购买）
5. 简单的装备UI

#### 第二阶段（扩展功能）
1. 装备强化系统
2. 装备耐久度和修复
3. 装备炼化系统
4. 装备交易系统
5. 装备图鉴

#### 第三阶段（高级功能）
1. 器灵系统
2. 套装系统
3. 装备进阶系统
4. 本命法宝系统
5. 特殊装备（成长型等）

### 14.2 文件结构建议

```
脚本/核心系统/装备系统/
├── 装备管理器.gd
├── 装备数据.gd
├── 器灵数据.gd
├── 强化系统.gd
├── 炼化系统.gd
└── 套装管理器.gd

数据/装备配置/
├── 装备库.json          # 所有装备基础数据
├── 武器配置.json        # 武器详细配置
├── 护甲配置.json        # 护甲详细配置
├── 饰品配置.json        # 饰品详细配置
├── 套装配置.json        # 套装效果配置
└── 词条库.json          # 特殊效果词条库
```

### 14.3 与现有系统集成

- **属性系统**: 装备属性加成到玩家属性
- **战斗系统**: 装备影响战斗力
- **炼器系统**: 玩家可炼制装备
- **背包系统**: 装备存放在背包
- **交易系统**: 装备可交易
- **门派系统**: 门派有专属装备

---

## 十五、平衡性建议

### 15.1 装备获取平衡

- 低级装备应该容易获得，高级装备稀有但不是完全不可得
- 氪金玩家可以更快获得装备，但肝帝也应该有途径
- 装备不应该是唯一提升战力的方式

### 15.2 强化平衡

- 低强化等级应该容易成功，高强化等级极难
- 强化失败不应该太痛苦，避免玩家退游
- 提供保底机制（保护符等）

### 15.3 器灵平衡

- 器灵应该是锦上添花，而非必需品
- 没有器灵的玩家也应该能正常游玩
- 器灵获取有一定难度，但不是不可能

---

**版本**: v1.0
**设计日期**: 2025-01-10
**参考来源**:
- 凡人修仙传（小说）
- 了不起的修仙模拟器、鬼谷八荒（游戏）
- 传统修仙法宝设定
