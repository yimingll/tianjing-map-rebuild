# 天京城跨区域连接与坐标系统设计

## 目录
1. [中心辐射式连接](#1-中心辐射式连接)
2. [环形连通路径](#2-环形连通路径)
3. [网格式交叉](#3-网格式交叉)
4. [层级式结构](#4-层级式结构)
5. [坐标系统](#5-坐标系统)
6. [完整连接矩阵](#6-完整连接矩阵)

---

## 1. 中心辐射式连接 (Hub-and-Spoke)

### 1.1 核心枢纽: 宫前广场

**房间ID**: `tj_palace_square`
**坐标**: (500, 550)
**连接数**: 8个方向

| 方向 | 目标区域 | 目标房间 | 距离(步) |
|------|---------|---------|----------|
| north | 皇城区内部 | tj_palace_gate | 1 |
| south | 商业区 | tj_imperial_street_north | 1 |
| east | 东城区 | tj_east_chang_an_street | 2 |
| west | 西城区 | tj_west_chang_an_street | 2 |
| northeast | 官府区 | tj_ministry_plaza | 2 |
| northwest | 皇城区内部 | tj_imperial_academy_gate | 2 |
| southeast | 商业区 | tj_imperial_street_mid | 2 |
| southwest | 西城区 | tj_west_plaza | 3 |

### 1.2 辐射到各区域的最短路径

```
宫前广场 → 各区域最短路径:

1. 宫前广场 → 商业区 (1步)
   tj_palace_square → tj_imperial_street_north

2. 宫前广场 → 南门区 (3步)
   tj_palace_square → tj_imperial_street_north → tj_imperial_street_mid → tj_south_gate_plaza

3. 宫前广场 → 东城区 (2步)
   tj_palace_square → tj_east_palace_plaza → tj_east_chang_an_street

4. 宫前广场 → 西城区 (2步)
   tj_palace_square → tj_west_palace_plaza → tj_west_chang_an_street

5. 宫前广场 → 官府区 (2步)
   tj_palace_square → tj_imperial_academy_gate → tj_ministry_plaza

6. 宫前广场 → 北门区 (3步)
   tj_palace_square → 皇宫后门 → tj_central_avenue → tj_north_gate_tower

7. 宫前广场 → 东门区 (4步)
   tj_palace_square → 东城区 → tj_east_chang_an_street → tj_east_gate_inside

8. 宫前广场 → 西门区 (4步)
   tj_palace_square → 西城区 → tj_west_chang_an_street → tj_west_gate_inside

9. 宫前广场 → 贫民区 (5步)
   tj_palace_square → 西城区 → tj_west_market_plaza → tj_slum_north_alley

10. 宫前广场 → 城墙区 (6步)
    tj_palace_square → 南门区 → tj_south_plaza_east → tj_southeast_corner_tower
```

---

## 2. 环形连通路径

### 2.1 外环线 - 四大城门环线

**环线总长**: 约30-35个房间
**完整路径**:

```
南门区 (起点)
  ↓ (东南路,2步)
城墙区-东南角楼
  ↓ (东城墙,3步)
东门区
  ↓ (东北路,2步)
城墙区-东北角楼
  ↓ (北城墙,3步)
北门区
  ↓ (西北路,2步)
城墙区-西北角楼
  ↓ (西城墙,3步)
西门区
  ↓ (西南路,2步)
城墙区-西南角楼
  ↓ (南城墙,3步)
回到南门区 (完成环线)
```

**详细房间序列**:
1. tj_south_gate_plaza (南门广场)
2. tj_south_plaza_east (南广场东侧)
3. tj_southeast_corner_tower (东南角楼)
4. tj_south_wall_patrol (南城墙巡逻道)
5. tj_east_wall_patrol (东城墙巡逻道)
6. tj_northeast_corner_tower (东北角楼)
7. tj_east_gate_warehouse (东门货栈)
8. tj_east_gate_inside (东门内)
9. tj_east_gate_passage (东门通道)
10. tj_east_gate_outside (东门外)
11. (...返回东门内...)
12. tj_northeast_corner_tower (再次)
13. tj_north_wall_patrol (北城墙巡逻道)
14. tj_northwest_corner_tower (西北角楼)
15. tj_north_gate_tower (北门城楼)
16. (...继续西行...)
17. tj_northwest_corner_tower (再次)
18. tj_west_wall_patrol (西城墙巡逻道)
19. tj_southwest_corner_tower (西南角楼)
20. tj_west_gate_post_station (西门驿站)
21. (...继续南行...)
22. tj_southwest_corner_tower (再次)
23. tj_south_wall_patrol (南城墙巡逻道)
24. tj_southeast_corner_tower (返回起点附近)
25. tj_south_plaza_east
26. tj_south_gate_plaza (完成环线)

### 2.2 内环线 - 商业生活环线

**环线总长**: 约15-20个房间
**完整路径**:

```
商业区 (起点)
  ↓ (大宅街,3步)
东城区
  ↓ (东长安街,4步)
官府区
  ↓ (西大街,3步)
西城区
  ↓ (西市街,3步)
回到商业区 (完成环线)
```

**详细房间序列**:
1. tj_imperial_street_mid (御街中段)
2. tj_commercial_crossroad (商业十字路口)
3. tj_mansion_street (大宅街)
4. tj_east_market_plaza (东市广场)
5. tj_east_chang_an_street (东长安街)
6. tj_ministry_plaza (六部广场)
7. tj_government_street (官道)
8. tj_west_main_street (西大街)
9. tj_west_market_plaza (西市广场)
10. tj_workshop_street (作坊街)
11. tj_commercial_crossroad (返回起点附近)
12. tj_imperial_street_mid (完成环线)

### 2.3 中环线 - 皇城周边环线

**路径**:
```
皇城东侧 → 官府区 → 皇城北侧 → 西城区 → 皇城西侧 → 商业区 → 皇城南侧 → 东城区 → 回到皇城东侧
```

---

## 3. 网格式交叉

### 3.1 主轴线

#### 横向主轴 (东西向)
**长安街主轴**: 东门 ← 东城 ← 皇城 → 西城 → 西门

```
东门区 (起点,X=900)
  ← west (6步)
东城区 东长安街 (X=750)
  ← west (4步)
皇城区 宫前广场 (X=500)
  → east (4步)
西城区 西长安街 (X=250)
  → east (6步)
西门区 (终点,X=100)
```

**总长度**: 约20个房间
**房间列表**:
1. tj_east_gate_inside (900, 500)
2. tj_east_chang_an_street (750, 500)
3. tj_east_market_plaza (700, 520)
4. ... (东城区内部)
5. tj_east_palace_plaza (600, 550)
6. tj_palace_square (500, 550) ⭐核心交叉点
7. tj_west_palace_plaza (400, 550)
8. ... (西城区内部)
9. tj_west_market_plaza (250, 520)
10. tj_west_chang_an_street (250, 500)
11. tj_west_gate_inside (100, 500)

#### 纵向主轴 (南北向)
**御街中轴**: 北门 ← 皇城 → 商业 → 南门

```
北门区 (起点,Y=850)
  ← south (5步)
皇城区 宫前广场 (Y=550)
  → south (3步)
商业区 御街中段 (Y=400)
  → south (4步)
南门区 南门广场 (Y=150)
```

**总长度**: 约12个房间
**房间列表**:
1. tj_north_gate_inside (500, 850)
2. tj_central_avenue (500, 750)
3. tj_north_parade_ground (500, 700)
4. ... (北门区/皇城北部)
5. tj_palace_square (500, 550) ⭐核心交叉点
6. tj_imperial_street_north (500, 480)
7. tj_imperial_street_mid (500, 400) ⭐次级交叉点
8. tj_imperial_street_south (500, 320)
9. tj_imperial_street_plaza (500, 250)
10. tj_south_gate_plaza (500, 150)

### 3.2 副轴线

#### 横向副轴1 (北部)
**六部街轴**: 东市广场 ← 官府 → 西大街

```
tj_east_market_plaza (750, 575) ← tj_ministry_plaza (675, 575) → tj_west_main_street (325, 575)
```

#### 横向副轴2 (南部)
**商业横街**: 东侧商铺 ← 商业区 → 西侧商铺

```
tj_jewelry_shop (550, 400) ← tj_imperial_street_mid (500, 400) → tj_weapon_shop (450, 400)
```

#### 纵向副轴1 (东部)
**东部纵线**: 北门 → 东城 → 南门

```
tj_northeast_corner_tower (850, 750) → tj_east_market_plaza (750, 575) → tj_mansion_street (750, 450) → tj_southeast_corner_tower (850, 250)
```

#### 纵向副轴2 (西部)
**西部纵线**: 北门 → 西城/贫民区 → 南门

```
tj_northwest_corner_tower (150, 750) → tj_west_market_plaza (250, 500) → tj_slum_main_alley (225, 325) → tj_southwest_corner_tower (150, 250)
```

### 3.3 关键交叉点

| 序号 | 房间名称 | 坐标 | 连接数 | 说明 |
|------|---------|------|--------|------|
| 1 | 宫前广场 | (500, 550) | 8 | 主轴核心交叉,全城中心 |
| 2 | 御街中段 | (500, 400) | 6 | 南北主轴+东西商业线交叉 |
| 3 | 六部广场 | (675, 575) | 6 | 官府中心,连接东西南北 |
| 4 | 东市广场 | (750, 520) | 5 | 东部枢纽,商业+住宅 |
| 5 | 西市广场 | (250, 500) | 5 | 西部枢纽,平民+作坊 |
| 6 | 南门广场 | (500, 150) | 5 | 南部枢纽,主入口 |
| 7 | 商业十字路口 | (500, 380) | 4 | 商业区内部交叉 |

---

## 4. 层级式结构

### 4.1 三层架构

```
【第三层 - 权力核心】(25房间)
           皇城区
    ┌──────┼──────┐
    │      │      │

【第二层 - 功能区域】(62房间)
  官府区  商业区  东城区
    │      │      │
  西城区  贫民区  (连接)

【第一层 - 外围防御】(53房间)
  北门区  城墙区  东门区
    │      │      │
  西门区  南门区  (连接)
```

### 4.2 层级间连接

#### 第三层 → 第二层 (核心 → 功能)

| 起点(皇城区) | 终点(功能区) | 连接房间 | 步数 |
|-------------|-------------|---------|------|
| 宫前广场 | 商业区 | 御街北段 | 1 |
| 东宫广场 | 东城区 | 东长安街 | 1 |
| 西宫广场 | 西城区 | 西长安街 | 1 |
| 国子监 | 官府区 | 六部广场 | 1 |

#### 第二层 → 第一层 (功能 → 外围)

| 起点(功能区) | 终点(外围) | 连接房间 | 步数 |
|-------------|-----------|---------|------|
| 商业区 | 南门区 | 御街南段 | 2 |
| 东城区 | 东门区 | 东长安街 | 3 |
| 西城区 | 西门区 | 西长安街 | 3 |
| 官府区 | 北门区 | 中轴大道 | 2 |
| 贫民区 | 南门区 | 南广场西侧 | 3 |

#### 跨层直达 (第三层 → 第一层)

| 起点(核心) | 终点(外围) | 路径 | 总步数 |
|-----------|-----------|------|--------|
| 宫前广场 | 南门区 | 御街直达 | 3 |
| 宫前广场 | 北门区 | 中轴大道 | 4 |
| 宫前广场 | 东门区 | 东长安街 | 5 |
| 宫前广场 | 西门区 | 西长安街 | 5 |

---

## 5. 坐标系统

### 5.1 整体布局

**地图范围**: 1000 × 1000
**坐标原点**: 左下角 (0, 0)
**中心点**: (500, 500)

```
        0        250       500       750      1000 (X轴)
     1000 ┌────────┬────────┬────────┬────────┐
          │西北角  │ 北门区 │        │东北角  │
     750  ├────────┼────────┼────────┼────────┤
          │        │        │ 官府区 │        │
          │西门区  │西城区  │皇城区  │东城区  │东门区
     500  │        │        │  ⭐   │        │
          │        │贫民区  │        │        │
     250  ├────────┼────────┼────────┼────────┤
          │西南角  │ 南门区 │ 商业区 │东南角  │
       0  └────────┴────────┴────────┴────────┘
        (Y轴)
```

### 5.2 各区域坐标范围

| 区域 | X最小 | X最大 | Y最小 | Y最大 | 中心坐标 | 面积 |
|------|-------|-------|-------|-------|---------|------|
| 皇城区 | 400 | 600 | 500 | 650 | (500, 575) | 200×150 |
| 商业区 | 420 | 580 | 320 | 480 | (500, 400) | 160×160 |
| 南门区 | 420 | 580 | 50 | 280 | (500, 165) | 160×230 |
| 北门区 | 420 | 580 | 720 | 950 | (500, 835) | 160×230 |
| 东城区 | 650 | 900 | 400 | 650 | (775, 525) | 250×250 |
| 西城区 | 100 | 350 | 400 | 650 | (225, 525) | 250×250 |
| 官府区 | 600 | 800 | 550 | 700 | (700, 625) | 200×150 |
| 东门区 | 900 | 980 | 450 | 550 | (940, 500) | 80×100 |
| 西门区 | 20 | 100 | 450 | 550 | (60, 500) | 80×100 |
| 贫民区 | 150 | 350 | 250 | 450 | (250, 350) | 200×200 |
| 城墙区 | 外围 | 环形 | - | - | 四角楼 | - |

### 5.3 关键房间坐标表

#### 核心枢纽 (Tier 1)
| 房间ID | 房间名称 | X | Y | 连接数 |
|--------|---------|---|---|--------|
| tj_palace_square | 宫前广场 | 500 | 575 | 8 |
| tj_ministry_plaza | 六部广场 | 700 | 625 | 6 |
| tj_imperial_street_mid | 御街中段 | 500 | 400 | 6 |

#### 区域枢纽 (Tier 2)
| 房间ID | 房间名称 | X | Y | 连接数 |
|--------|---------|---|---|--------|
| tj_south_gate_plaza | 南门广场 | 500 | 150 | 5 |
| tj_north_gate_tower | 北门城楼 | 500 | 850 | 5 |
| tj_east_market_plaza | 东市广场 | 775 | 575 | 5 |
| tj_west_market_plaza | 西市广场 | 225 | 525 | 5 |
| tj_east_chang_an_street | 东长安街 | 775 | 575 | 4 |
| tj_west_chang_an_street | 西长安街 | 225 | 525 | 4 |

#### 城门入口 (Tier 3)
| 房间ID | 房间名称 | X | Y | 区域 |
|--------|---------|---|---|------|
| tj_south_gate_outside | 南门外 | 500 | 50 | 南门区 |
| tj_north_gate_outside | 北门外 | 500 | 950 | 北门区 |
| tj_east_gate_outside | 东门外 | 980 | 500 | 东门区 |
| tj_west_gate_outside | 西门外 | 20 | 500 | 西门区 |

#### 四角楼 (防御要点)
| 房间ID | 房间名称 | X | Y |
|--------|---------|---|---|
| tj_southeast_corner_tower | 东南角楼 | 900 | 200 |
| tj_northeast_corner_tower | 东北角楼 | 900 | 800 |
| tj_northwest_corner_tower | 西北角楼 | 100 | 800 |
| tj_southwest_corner_tower | 西南角楼 | 100 | 200 |

#### 特色地标
| 房间ID | 房间名称 | X | Y | 区域 |
|--------|---------|---|---|------|
| tj_bai_mansion_gate | 白家正门 | 800 | 500 | 东城区 |
| tj_slum_main_alley | 贫民区主巷 | 225 | 325 | 贫民区 |
| tj_throne_hall | 金銮殿 | 500 | 625 | 皇城区 |

### 5.4 坐标分配规则

#### 水平分布 (X轴)
- **西外围**: 0-100 (西门区、西侧城墙)
- **西部**: 100-400 (西城区、贫民区)
- **中部**: 400-600 (皇城区、商业区、南北门区)
- **东部**: 600-900 (东城区、官府区)
- **东外围**: 900-1000 (东门区、东侧城墙)

#### 垂直分布 (Y轴)
- **南外围**: 0-100 (南门外、南侧城墙)
- **南部**: 100-350 (南门区内、贫民区南部)
- **中部**: 350-650 (商业区、皇城区、东西城区)
- **北部**: 650-850 (官府区、北门区内)
- **北外围**: 850-1000 (北门外、北侧城墙)

#### 间距标准
- **相邻房间**: 20-50单位
- **区域间隔**: 80-100单位
- **枢纽到边缘**: 100-200单位
- **对角距离**: 300-500单位

---

## 6. 完整连接矩阵

### 6.1 11×11 区域连接矩阵

|        | 皇城 | 商业 | 东城 | 西城 | 官府 | 南门 | 北门 | 贫民 | 城墙 | 东门 | 西门 |
|--------|------|------|------|------|------|------|------|------|------|------|------|
| **皇城** | - | ✓ | ✓ | ✓ | ✓ | ✗ | ✓ | ✗ | ✗ | ✗ | ✗ |
| **商业** | ✓ | - | ✓ | ✓ | ✗ | ✓ | ✗ | ✓ | ✗ | ✗ | ✗ |
| **东城** | ✓ | ✓ | - | ✗ | ✓ | ✗ | ✗ | ✗ | ✗ | ✓ | ✗ |
| **西城** | ✓ | ✓ | ✗ | - | ✓ | ✗ | ✗ | ✓ | ✗ | ✗ | ✓ |
| **官府** | ✓ | ✗ | ✓ | ✓ | - | ✗ | ✓ | ✗ | ✗ | ✗ | ✗ |
| **南门** | ✗ | ✓ | ✗ | ✗ | ✗ | - | ✗ | ✓ | ✓ | ✗ | ✗ |
| **北门** | ✓ | ✗ | ✗ | ✗ | ✓ | ✗ | - | ✗ | ✓ | ✗ | ✗ |
| **贫民** | ✗ | ✓ | ✗ | ✓ | ✗ | ✓ | ✗ | - | ✗ | ✗ | ✗ |
| **城墙** | ✗ | ✗ | ✗ | ✗ | ✗ | ✓ | ✓ | ✗ | - | ✓ | ✓ |
| **东门** | ✗ | ✗ | ✓ | ✗ | ✗ | ✗ | ✗ | ✗ | ✓ | - | ✗ |
| **西门** | ✗ | ✗ | ✗ | ✓ | ✗ | ✗ | ✗ | ✗ | ✓ | ✗ | - |

**图例**:
- ✓ = 有直接连接
- ✗ = 无直接连接
- - = 区域自身

### 6.2 区域连接度统计

| 区域 | 直接连接数 | 连接的区域列表 |
|------|-----------|--------------|
| 皇城区 | 5 | 商业、东城、西城、官府、北门 |
| 商业区 | 5 | 皇城、东城、西城、南门、贫民 |
| 东城区 | 4 | 皇城、商业、官府、东门 |
| 西城区 | 5 | 皇城、商业、官府、贫民、西门 |
| 官府区 | 4 | 皇城、东城、西城、北门 |
| 南门区 | 3 | 商业、贫民、城墙 |
| 北门区 | 3 | 皇城、官府、城墙 |
| 贫民区 | 3 | 商业、西城、南门 |
| 城墙区 | 4 | 南门、北门、东门、西门 |
| 东门区 | 2 | 东城、城墙 |
| 西门区 | 2 | 西城、城墙 |

**平均连接度**: 3.6 (良好的连通性)

### 6.3 最短路径表 (关键区域对)

| 起点 | 终点 | 最短路径 | 步数 |
|------|------|---------|------|
| 南门 | 北门 | 南门→商业→皇城→北门 | 6 |
| 东门 | 西门 | 东门→东城→皇城→西城→西门 | 8 |
| 贫民 | 官府 | 贫民→西城→官府 | 4 |
| 东城 | 西城 | 东城→皇城→西城 | 4 |
| 商业 | 官府 | 商业→皇城→官府 | 4 |

---

**文档版本**: v1.0
**创建日期**: 2025-11-18
**连接总数**: 40个跨区域连接点
**连通性验证**: ✓ 无孤岛,所有区域可达
